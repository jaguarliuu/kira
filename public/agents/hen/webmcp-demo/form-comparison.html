<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebMCP æ™ºèƒ½è¡¨å•å¯¹æ¯” Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      min-height: 100vh;
      color: #fff;
      padding: 2rem;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .logo {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: #888;
      margin-bottom: 1rem;
    }

    .webmcp-badge {
      display: inline-block;
      padding: 0.5rem 1rem;
      background: linear-gradient(90deg, #667eea, #764ba2);
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
    }

    /* å¯¹æ¯”é¢æ¿ */
    .comparison-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .method-card {
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s;
    }

    .method-card:hover {
      background: rgba(255,255,255,0.1);
      transform: translateY(-4px);
    }

    .method-card.active {
      border-color: #667eea;
      box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
    }

    .method-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .method-icon {
      font-size: 1.5rem;
    }

    .method-title {
      font-weight: 600;
      font-size: 1.1rem;
    }

    .method-stats {
      display: grid;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .stat {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
    }

    .stat-value {
      font-weight: 600;
    }

    .stat-value.good {
      color: #2ecc71;
    }

    .stat-value.bad {
      color: #e74c3c;
    }

    .stat-value.medium {
      color: #f39c12;
    }

    .method-actions {
      margin-top: 1rem;
    }

    .btn {
      padding: 0.6rem 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s;
      width: 100%;
    }

    .btn-primary {
      background: linear-gradient(90deg, #667eea, #764ba2);
      color: white;
    }

    .btn-primary:hover {
      transform: scale(1.02);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* è¡¨å•åŒºåŸŸ */
    .form-section {
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .form-title {
      font-size: 1.3rem;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
    }

    .form-group {
      margin-bottom: 0;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      font-size: 0.9rem;
      color: #aaa;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.8rem 1rem;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      color: white;
      font-size: 1rem;
      transition: all 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
      background: rgba(255,255,255,0.1);
    }

    .form-group input::placeholder {
      color: #666;
    }

    /* æŠ€èƒ½å¤é€‰æ¡† */
    .skills-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.8rem;
    }

    .skill-checkbox {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid transparent;
    }

    .skill-checkbox:hover {
      background: rgba(255,255,255,0.1);
    }

    .skill-checkbox.selected {
      background: rgba(102, 126, 234, 0.2);
      border-color: #667eea;
    }

    .skill-checkbox input {
      width: auto;
    }

    /* æ—¥å¿—é¢æ¿ */
    .log-panel {
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 2rem;
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 0.85rem;
      max-height: 300px;
      overflow-y: auto;
    }

    .log-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      color: #888;
    }

    .log-entry {
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      border-radius: 6px;
      border-left: 3px solid #666;
    }

    .log-entry.webmcp {
      border-color: #2ecc71;
      background: rgba(46, 204, 113, 0.1);
    }

    .log-entry.screenshot {
      border-color: #e74c3c;
      background: rgba(231, 76, 60, 0.1);
    }

    .log-entry.manual {
      border-color: #3498db;
      background: rgba(52, 152, 219, 0.1);
    }

    .log-time {
      color: #888;
      margin-right: 1rem;
    }

    .log-method {
      font-weight: 600;
      margin-right: 0.5rem;
    }

    .log-method.webmcp {
      color: #2ecc71;
    }

    .log-method.screenshot {
      color: #e74c3c;
    }

    .log-method.manual {
      color: #3498db;
    }

    /* ç»“æœå±•ç¤º */
    .result-panel {
      background: rgba(46, 204, 113, 0.1);
      border: 1px solid #2ecc71;
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1rem;
      display: none;
    }

    .result-panel.show {
      display: block;
    }

    .result-title {
      font-weight: 600;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .result-content {
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 1rem;
      white-space: pre-wrap;
      font-family: monospace;
    }

    /* WebMCP å·¥å…·é¢æ¿ */
    .tools-panel {
      background: rgba(118, 75, 162, 0.1);
      border: 1px solid rgba(118, 75, 162, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .tools-title {
      font-size: 1.1rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .tools-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .tool-item {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 1rem;
    }

    .tool-name {
      font-family: monospace;
      color: #667eea;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .tool-desc {
      font-size: 0.85rem;
      color: #888;
      margin-bottom: 0.5rem;
    }

    .tool-schema {
      font-size: 0.75rem;
      color: #666;
      background: rgba(0,0,0,0.2);
      padding: 0.5rem;
      border-radius: 4px;
      font-family: monospace;
    }

    /* ç»Ÿè®¡é¢æ¿ */
    .stats-overview {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .overview-card {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
    }

    .overview-value {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .overview-label {
      color: #888;
      font-size: 0.9rem;
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .comparison-grid {
        grid-template-columns: 1fr;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .skills-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .tools-grid {
        grid-template-columns: 1fr;
      }
      
      .stats-overview {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">ğŸ“</div>
      <h1>WebMCP æ™ºèƒ½è¡¨å•å¯¹æ¯” Demo</h1>
      <p class="subtitle">åŒä¸€ä¸ªè¡¨å•ï¼Œä¸‰ç§æ“ä½œæ–¹å¼çš„æ•ˆç‡å¯¹æ¯”</p>
      <span class="webmcp-badge">ğŸ”Œ WebMCP Enabled</span>
    </header>

    <!-- æ•ˆç‡ç»Ÿè®¡ -->
    <div class="stats-overview">
      <div class="overview-card">
        <div class="overview-value" id="totalTimeWebmcp" style="color: #2ecc71;">0ms</div>
        <div class="overview-label">WebMCP è€—æ—¶</div>
      </div>
      <div class="overview-card">
        <div class="overview-value" id="totalTimeScreenshot" style="color: #e74c3c;">0ms</div>
        <div class="overview-label">æˆªå›¾æ–¹å¼è€—æ—¶</div>
      </div>
      <div class="overview-card">
        <div class="overview-value" id="tokenSaved" style="color: #f39c12;">0%</div>
        <div class="overview-label">Token èŠ‚çœ</div>
      </div>
    </div>

    <!-- æ“ä½œæ–¹å¼å¯¹æ¯” -->
    <div class="comparison-grid">
      <div class="method-card" id="webmcpCard">
        <div class="method-header">
          <span class="method-icon">âš¡</span>
          <span class="method-title">WebMCP ç›´æ¥è°ƒç”¨</span>
        </div>
        <div class="method-stats">
          <div class="stat">
            <span>è€—æ—¶</span>
            <span class="stat-value good" id="webmcpTime">~2ms</span>
          </div>
          <div class="stat">
            <span>Token</span>
            <span class="stat-value good" id="webmcpTokens">~500</span>
          </div>
          <div class="stat">
            <span>æˆåŠŸç‡</span>
            <span class="stat-value good">100%</span>
          </div>
        </div>
        <div class="method-actions">
          <button class="btn btn-primary" onclick="submitViaWebMCP()">âš¡ WebMCP ä¸€é”®æäº¤</button>
        </div>
      </div>

      <div class="method-card" id="screenshotCard">
        <div class="method-header">
          <span class="method-icon">ğŸ“¸</span>
          <span class="method-title">æˆªå›¾ + ç‚¹å‡»æ¨¡æ‹Ÿ</span>
        </div>
        <div class="method-stats">
          <div class="stat">
            <span>è€—æ—¶</span>
            <span class="stat-value bad" id="screenshotTime">30-60s</span>
          </div>
          <div class="stat">
            <span>Token</span>
            <span class="stat-value bad" id="screenshotTokens">~50,000</span>
          </div>
          <div class="stat">
            <span>æˆåŠŸç‡</span>
            <span class="stat-value medium">~85%</span>
          </div>
        </div>
        <div class="method-actions">
          <button class="btn btn-primary" onclick="simulateScreenshot()" disabled>ğŸš§ æ¨¡æ‹Ÿä¸­...</button>
        </div>
      </div>

      <div class="method-card" id="manualCard">
        <div class="method-header">
          <span class="method-icon">ğŸ‘¤</span>
          <span class="method-title">äººå·¥æ‰‹åŠ¨å¡«å†™</span>
        </div>
        <div class="method-stats">
          <div class="stat">
            <span>è€—æ—¶</span>
            <span class="stat-value medium" id="manualTime">60-120s</span>
          </div>
          <div class="stat">
            <span>è„‘åŠ›</span>
            <span class="stat-value medium">ä¸­</span>
          </div>
          <div class="stat">
            <span>æˆåŠŸç‡</span>
            <span class="stat-value good">99%</span>
          </div>
        </div>
        <div class="method-actions">
          <button class="btn btn-primary" disabled>ğŸ‘¨â€ğŸ’» äººå·¥æ“ä½œ</button>
        </div>
      </div>
    </div>

    <!-- WebMCP å·¥å…·é¢æ¿ -->
    <div class="tools-panel">
      <h2 class="tools-title">ğŸ”§ å·²æš´éœ²çš„ WebMCP å·¥å…·</h2>
      <div class="tools-grid">
        <div class="tool-item">
          <div class="tool-name">submit_form</div>
          <div class="tool-desc">æäº¤å‘˜å·¥å…¥èŒè¡¨å•</div>
          <div class="tool-schema">name, email, department, skills[], preferences</div>
        </div>
        <div class="tool-item">
          <div class="tool-name">validate_field</div>
          <div class="tool-desc">éªŒè¯å•ä¸ªå­—æ®µ</div>
          <div class="tool-schema">field_name, value</div>
        </div>
        <div class="tool-item">
          <div class="tool-name">get_depart_options</div>
          <div class="tool-desc">è·å–éƒ¨é—¨åˆ—è¡¨</div>
          <div class="tool-schema">æ— å‚æ•°</div>
        </div>
        <div class="tool-item">
          <div class="tool-name">get_skills_list</div>
          <div class="tool-desc">è·å–æŠ€èƒ½åˆ—è¡¨</div>
          <div class="tool-schema">æ— å‚æ•°</div>
        </div>
      </div>
    </div>

    <!-- è¡¨å• -->
    <div class="form-section">
      <h2 class="form-title">ğŸ“ å‘˜å·¥å…¥èŒè¡¨å•</h2>
      <form id="onboardingForm" tool-name="submit_form" tool-description="æäº¤å‘˜å·¥å…¥èŒè¡¨å•">
        <div class="form-grid">
          <div class="form-group">
            <label for="name">å§“å *</label>
            <input type="text" id="name" name="name" required placeholder="è¯·è¾“å…¥å§“å"
                   tool-param-name="name" tool-param-description="å‘˜å·¥å§“å">
          </div>
          <div class="form-group">
            <label for="email">é‚®ç®± *</label>
            <input type="email" id="email" name="email" required placeholder="name@company.com"
                   tool-param-name="email" tool-param-description="å…¬å¸é‚®ç®±">
          </div>
          <div class="form-group">
            <label for="department">éƒ¨é—¨ *</label>
            <select id="department" name="department" required
                    tool-param-name="department" tool-param-description="æ‰€å±éƒ¨é—¨">
              <option value="">é€‰æ‹©éƒ¨é—¨</option>
              <option value="engineering">å·¥ç¨‹éƒ¨</option>
              <option value="product">äº§å“éƒ¨</option>
              <option value="design">è®¾è®¡éƒ¨</option>
              <option value="marketing">å¸‚åœºéƒ¨</option>
              <option value="hr">äººäº‹éƒ¨</option>
              <option value="finance">è´¢åŠ¡éƒ¨</option>
            </select>
          </div>
          <div class="form-group">
            <label for="position">èŒä½ *</label>
            <input type="text" id="position" name="position" required placeholder="å¦‚ï¼šé«˜çº§å·¥ç¨‹å¸ˆ"
                   tool-param-name="position" tool-param-description="èŒä½åç§°">
          </div>
          <div class="form-group full-width">
            <label>æŠ€èƒ½ *</label>
            <div class="skills-grid" id="skillsGrid">
              <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
          </div>
          <div class="form-group full-width">
            <label for="startDate">å…¥èŒæ—¥æœŸ *</label>
            <input type="date" id="startDate" name="start_date" required
                   tool-param-name="start_date" tool-param-description="å…¥èŒæ—¥æœŸ YYYY-MM-DD">
          </div>
          <div class="form-group full-width">
            <label for="notes">å¤‡æ³¨</label>
            <textarea id="notes" name="notes" rows="3" placeholder="å…¶ä»–éœ€è¦è¯´æ˜çš„äº‹é¡¹..."
                      tool-param-name="notes" tool-param-description="å¤‡æ³¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰"></textarea>
          </div>
        </div>
      </form>
    </div>

    <!-- æ—¥å¿—é¢æ¿ -->
    <div class="log-panel">
      <div class="log-title">ğŸ“‹ æ“ä½œæ—¥å¿—</div>
      <div id="logContainer">
        <div class="log-entry manual">
          <span class="log-time">00:00:00</span>
          <span class="log-method manual">ç³»ç»Ÿ</span>
          <span>é¡µé¢å·²åŠ è½½ï¼ŒWebMCP å·¥å…·å·²æ³¨å†Œ</span>
        </div>
      </div>
    </div>

    <!-- ç»“æœé¢æ¿ -->
    <div class="result-panel" id="resultPanel">
      <div class="result-title">âœ… æäº¤æˆåŠŸ</div>
      <div class="result-content" id="resultContent"></div>
    </div>
  </div>

  <script>
    // ========== æ•°æ® ==========
    const skills = [
      { id: 'python', name: 'Python' },
      { id: 'javascript', name: 'JavaScript' },
      { id: 'typescript', name: 'TypeScript' },
      { id: 'java', name: 'Java' },
      { id: 'go', name: 'Go' },
      { id: 'rust', name: 'Rust' },
      { id: 'react', name: 'React' },
      { id: 'vue', name: 'Vue.js' },
      { id: 'nodejs', name: 'Node.js' },
      { id: 'sql', name: 'SQL' },
      { id: 'docker', name: 'Docker' },
      { id: 'kubernetes', name: 'Kubernetes' }
    ];

    const selectedSkills = new Set();

    // ========== å·¥å…·å‡½æ•° ==========
    function addLog(method, message) {
      const container = document.getElementById('logContainer');
      const time = new Date().toLocaleTimeString('zh-CN', { hour12: '2-digit', minute: '2-digit', second: '2-digit' });
      
      const entry = document.createElement('div');
      entry.className = `log-entry ${method}`;
      entry.innerHTML = `
        <span class="log-time">${time}</span>
        <span class="log-method ${method}">${getMethodLabel(method)}</span>
        <span>${message}</span>
      `;
      
      container.appendChild(entry);
      container.scrollTop = container.scrollHeight;
    }

    function getMethodLabel(method) {
      const labels = {
        webmcp: 'WebMCP',
        screenshot: 'æˆªå›¾',
        manual: 'æ‰‹åŠ¨'
      };
      return labels[method] || method;
    }

    function showResult(data) {
      const panel = document.getElementById('resultPanel');
      const content = document.getElementById('resultContent');
      panel.classList.add('show');
      content.textContent = JSON.stringify(data, null, 2);
    }

    function updateStats(webmcpTime, screenshotTime) {
      const webmcpTokens = 500;
      const screenshotTokens = 50000;
      
      document.getElementById('webmcpTime').textContent = `~${webmcpTime}ms`;
      document.getElementById('webmcpTokens').textContent = `~${webmcpTokens}`;
      document.getElementById('screenshotTime').textContent = `~${screenshotTime}s`;
      document.getElementById('screenshotTokens').textContent = `~${screenshotTokens.toLocaleString()}`;
      
      document.getElementById('totalTimeWebmcp').textContent = `${webmcpTime}ms`;
      document.getElementById('totalTimeScreenshot').textContent = `${screenshotTime}s`;
      document.getElementById('tokenSaved').textContent = `${Math.round((1 - webmcpTokens/screenshotTokens) * 100)}%`;
      
      // æ›´æ–°å¡ç‰‡çŠ¶æ€
      document.getElementById('webmcpCard').classList.add('active');
    }

    // ========== æŠ€èƒ½æ¸²æŸ“ ==========
    function renderSkills() {
      const grid = document.getElementById('skillsGrid');
      grid.innerHTML = skills.map(skill => `
        <div class="skill-checkbox" onclick="toggleSkill('${skill.id}', this)">
          <input type="checkbox" name="skills" value="${skill.id}">
          <span>${skill.name}</span>
        </div>
      `).join('');
    }

    function toggleSkill(skillId, element) {
      if (selectedSkills.has(skillId)) {
        selectedSkills.delete(skillId);
        element.classList.remove('selected');
      } else {
        selectedSkills.add(skillId);
        element.classList.add('selected');
      }
    }

    // ========== WebMCP æäº¤ ==========
    async function submitViaWebMCP() {
      const startTime = performance.now();
      addLog('webmcp', 'å¼€å§‹é€šè¿‡ WebMCP æäº¤è¡¨å•...');
      
      // æ”¶é›†è¡¨å•æ•°æ®
      const formData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        department: document.getElementById('department').value,
        position: document.getElementById('position').value,
        skills: Array.from(selectedSkills),
        start_date: document.getElementById('startDate').value,
        notes: document.getElementById('notes').value
      };

      // éªŒè¯
      if (!formData.name || !formData.email || !formData.department || !formData.position || formData.skills.length === 0) {
        addLog('webmcp', 'âŒ è¡¨å•éªŒè¯å¤±è´¥ï¼šè¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹');
        return;
      }

      addLog('webmcp', `å‡†å¤‡æ•°æ®: ${JSON.stringify(formData)}`);
      addLog('webmcp', 'è°ƒç”¨ navigator.modelContext.call("submit_form", data)');
      
      // æ¨¡æ‹Ÿ WebMCP è°ƒç”¨
      await new Promise(resolve => setTimeout(resolve, 50));
      
      const endTime = performance.now();
      const elapsed = endTime - startTime;
      
      // æ›´æ–°ç»Ÿè®¡
      updateStats(Math.round(elapsed), 45);
      
      addLog('webmcp', `âœ… æäº¤æˆåŠŸï¼è€—æ—¶ ${elapsed}ms`);
      
      showResult({
        success: true,
        employee_id: 'EMP' + Date.now().toString(36).toUpperCase(),
        data: formData,
        message: 'å‘˜å·¥å…¥èŒè¡¨å•å·²æˆåŠŸæäº¤'
      });
    }

    // ========== æ¨¡æ‹Ÿæˆªå›¾æ–¹å¼ ==========
    async function simulateScreenshot() {
      addLog('screenshot', 'å¼€å§‹æ¨¡æ‹Ÿæˆªå›¾æ–¹å¼...');
      
      const steps = [
        { action: 'æˆªå–é¡µé¢æˆªå›¾', time: 1.5 },
        { action: 'OCR è¯†åˆ«è¡¨å•å…ƒç´ ', time: 2 },
        { action: 'å®šä½å§“åè¾“å…¥æ¡†', time: 0.5 },
        { action: 'ç‚¹å‡»å§“åè¾“å…¥æ¡†', time: 0.3 },
        { action: 'è¾“å…¥å§“åæ•°æ®', time: 0.2 },
        { action: 'å®šä½é‚®ç®±è¾“å…¥æ¡†', time: 0.5 },
        { action: 'ç‚¹å‡»é‚®ç®±è¾“å…¥æ¡†', time: 0.3 },
        { action: 'è¾“å…¥é‚®ç®±æ•°æ®', time: 0.2 },
        { action: 'å®šä½éƒ¨é—¨ä¸‹æ‹‰æ¡†', time: 0.5 },
        { action: 'ç‚¹å‡»éƒ¨é—¨ä¸‹æ‹‰æ¡†', time: 0.3 },
        { action: 'è¯†åˆ«ä¸‹æ‹‰é€‰é¡¹', time: 1 },
        { action: 'é€‰æ‹©éƒ¨é—¨', time: 0.2 },
        { action: 'å®šä½èŒä½è¾“å…¥æ¡†', time: 0.5 },
        { action: 'ç‚¹å‡»èŒä½è¾“å…¥æ¡†', time: 0.3 },
        { action: 'è¾“å…¥èŒä½æ•°æ®', time: 0.2 },
        { action: 'å®šä½æŠ€èƒ½å¤é€‰æ¡†', time: 0.5 },
        { action: 'è¯†åˆ«å¤é€‰æ¡†çŠ¶æ€', time: 1 },
        { action: 'ç‚¹å‡»æŠ€èƒ½å¤é€‰æ¡† x 3', time: 0.6 },
        { action: 'å®šä½å…¥èŒæ—¥æœŸè¾“å…¥æ¡†', time: 0.5 },
        { action: 'ç‚¹å‡»æ—¥æœŸé€‰æ‹©å™¨', time: 0.3 },
        { action: 'é€‰æ‹©æ—¥æœŸ', time: 0.2 },
        { action: 'å®šä½æäº¤æŒ‰é’®', time: 0.5 },
        { action: 'ç‚¹å‡»æäº¤æŒ‰é’®', time: 0.3 },
        { action: 'ç­‰å¾…å“åº”', time: 2 }
      ];

      let total = 0;
      for (const step of steps) {
        await new Promise(resolve => setTimeout(resolve, step.time * 1000));
        addLog('screenshot', `ğŸ“¸ ${step.action}...`);
        total += step.time;
      }

      addLog('screenshot', `âŒ æˆªå›¾æ–¹å¼æ€»è€—æ—¶: ${total}ç§’`);
    }

    // ========== WebMCP å·¥å…·æ³¨å†Œ ==========
    async function registerWebMCPTools() {
      if (!navigator.modelContext) {
        console.log('WebMCP not supported');
        return;
      }

      try {
        // å·¥å…· 1: æäº¤è¡¨å•
        await navigator.modelContext.registerTool({
          name: 'submit_form',
          description: 'æäº¤å‘˜å·¥å…¥èŒè¡¨å•',
          inputSchema: {
            type: 'object',
            properties: {
              name: { type: 'string', description: 'å‘˜å·¥å§“å' },
              email: { type: 'string', description: 'å…¬å¸é‚®ç®±' },
              department: { type: 'string', description: 'æ‰€å±éƒ¨é—¨', enum: ['engineering', 'product', 'design', 'marketing', 'hr', 'finance'] },
              position: { type: 'string', description: 'èŒä½åç§°' },
              skills: { type: 'array', items: { type: 'string' }, description: 'æŠ€èƒ½åˆ—è¡¨' },
              start_date: { type: 'string', description: 'å…¥èŒæ—¥æœŸ' },
              notes: { type: 'string', description: 'å¤‡æ³¨ä¿¡æ¯' }
            },
            required: ['name', 'email', 'department', 'position', 'skills', 'start_date']
          },
          execute: async (params) => {
            // æ¨¡æ‹Ÿå¤„ç†
            await new Promise(r => setTimeout(r, 100));
            
            return {
              success: true,
              employee_id: 'EMP' + Date.now().toString(36).toUpperCase(),
              submitted_at: new Date().toISOString(),
              data: params
            };
          }
        });

        // å·¥å…· 2: éªŒè¯å­—æ®µ
        await navigator.modelContext.registerTool({
          name: 'validate_field',
          description: 'éªŒè¯è¡¨å•å­—æ®µ',
          inputSchema: {
            type: 'object',
            properties: {
                field_name: { type: 'string', description: 'å­—æ®µåç§°' },
                value: { type: 'string', description: 'å­—æ®µå€¼' }
            },
            required: ['field_name', 'value']
          },
          execute: async ({ field_name, value }) => {
            const validations = {
              name: (v) => v.length >= 2,
              email: (v) => /^[^\s@]+@[^\s@]+\.[^\s]+$/.test(v),
              department: (v) => ['engineering', 'product', 'design', 'marketing', 'hr', 'finance'].includes(v),
              position: (v) => v.length >= 2
            };
            
            const valid = validations[field_name]?.(value) ?? false;
            
            return {
              field: field_name,
              value,
              valid,
              message: valid ? `${field_name} éªŒè¯é€šè¿‡` : `${field_name} éªŒè¯å¤±è´¥`
            };
          }
        });

        // å·¥å…· 3: è·å–éƒ¨é—¨é€‰é¡¹
        await navigator.modelContext.registerTool({
          name: 'get_department_options',
          description: 'è·å–å¯é€‰çš„éƒ¨é—¨åˆ—è¡¨',
          inputSchema: { type: 'object', properties: {} },
          execute: async () => {
            return {
              departments: [
                { id: 'engineering', name: 'å·¥ç¨‹éƒ¨' },
                { id: 'product', name: 'äº§å“éƒ¨' },
                { id: 'design', name: 'è®¾è®¡éƒ¨' },
                { id: 'marketing', name: 'å¸‚åœºéƒ¨' },
                { id: 'hr', name: 'äººäº‹éƒ¨' },
                { id: 'finance', name: 'è´¢åŠ¡éƒ¨' }
              ]
            };
          }
        });

        // å·¥å…· 4: è·å–æŠ€èƒ½åˆ—è¡¨
        await navigator.modelContext.registerTool({
          name: 'get_skills_list',
          description: 'è·å–å¯é€‰æ‹©çš„æŠ€èƒ½åˆ—è¡¨',
          inputSchema: { type: 'object', properties: {} },
          execute: async () => {
            return { skills };
          }
        });

        console.log('WebMCP tools registered successfully');
        addLog('webmcp', '4 ä¸ª WebMCP å·¥å…·å·²æ³¨å†Œ: submit_form, validate_field, get_department_options, get_skills_list');
      } catch (error) {
        console.error('Failed to register WebMCP tools:', error);
      }
    }

    // ========== åˆå§‹åŒ– ==========
    document.addEventListener('DOMContentLoaded', () => {
      renderSkills();
      registerWebMCPTools();
      
      // è®¾ç½®æ—¥æœŸæœ€å°å€¼
      const dateInput = document.getElementById('startDate');
      const today = new Date().toISOString().split('T')[0];
      dateInput.min = today;
      dateInput.value = today;
      
      // å¡«å……ç¤ºä¾‹æ•°æ®
      document.getElementById('name').value = 'å¼ ä¸‰';
      document.getElementById('email').value = 'zhangsan@example.com';
      document.getElementById('position').value = 'é«˜çº§å·¥ç¨‹å¸ˆ';
      
      addLog('manual', 'å·²é¢„å¡«å……ç¤ºä¾‹æ•°æ®ï¼Œå¯ç›´æ¥ç‚¹å‡»æäº¤');
    });
  </script>
</body>
</html>
